
https://www.codeproject.com/Articles/4870/Connect-to-DB2-from-Microsoft-NET
OnCustomButtonCallback="ASPxGridView1_CustomButtonCallback">
                <ClientSideEvents CustomButtonClick="function(s,e){onASPxGridView1ButtonClick(s, e);}"  EndCallback="function(s,e){EndCallBack(s, e);}" />
 protected void ASPxGridView1_CustomButtonCallback(object sender, DevExpress.Web.ASPxGridViewCustomButtonCallbackEventArgs e)
        {
            if (e.ButtonID == "EditButton")
            {
                ASPxGridView view = sender as ASPxGridView;
                DataRowView dv = view.GetRow(view.FocusedRowIndex) as DataRowView;

                //New method to get the value of quasi account number
                int current_row_zzbh_val = 0;
                int.TryParse(view.GetRowValues(e.VisibleIndex, "Quasi Account Number").ToString(), out current_row_zzbh_val);

                //Original method to get the value of quasi-account number
                //int current_row_zzbh_val = Convert.ToInt32(dv.Row["quasi account number"]);

                List<int> no_zero_zzbh_list = new List<int> { };
                DataTable zzbh_dt = SqlHelper.ExecuteDataTable("select distinct standard account number from standard account book", new SqlParameter[] { });
                if (zzbh_dt.Rows.Count > 0)
                {
                    foreach (DataRow dr in zzbh_dt.Rows)
                    {
                        int zzbh_val = Convert.ToInt32(dr["Quasi Account Number"]);
                        object o_zzbhhj = SqlHelper.ExecuteScalar("select sum(receipt and payment amount) as receipt and payment amount from quasi-ledger account where quasi-ledger number=" + zzbh_val, new SqlParameter[] { });
                        double zzbhhj_val = Convert.IsDBNull(o_zzbhhj) ? 0 : Convert.ToDouble(o_zzbhhj);
                        if (zzbhhj_val != 0)
                        {
                            no_zero_zzbh_list.Add(zzbh_val);
                        }
                    }
                    //If there is a quasi-account number whose quasi-account number is not equal to 0
                    if (no_zero_zzbh_list.Count > 0)
                    {
                        //If the current quasi-account number is not included in the set of quasi-account numbers whose quasi-account number is not equal to 0, it will prompt and tell the operator which quasi-account number can be modified!
                        if (!no_zero_zzbh_list.Contains(current_row_zzbh_val))
                        {
                            string no_zero_zzbh_str = "";
                            for (int i = 0; i < no_zero_zzbh_list.Count; i++)
                            {
                                no_zero_zzbh_str += no_zero_zzbh_list[i].ToString().Trim() + ";";
                            }
                            no_zero_zzbh_str = no_zero_zzbh_str.Substring(0, no_zero_zzbh_str.Length - 1);
                            view.JSProperties["cpErrorMsg"] = "The current line cannot be modified! Because there is a quasi-account number whose quasi-account number is not equal to 0! You can only modify the quasi-account number:" + no_zero_zzbh_str + "record of!";
                            view.DataBind();

                        }
                        else
                        {
                            //If it is included in the collection whose quasi-account number is not 0, it can be modified
                            view.JSProperties["cpErrorMsg"] = "";//The key here is: cp in cpErrorMsg must be lowercase
                            view.DataBind();
                            ASPxGridView1.StartEdit(view.FocusedRowIndex);
                        }
                    }
                    else
                    {
                        //If there is no record with quasi-account number not equal to 0, you can modify all rows
                        view.JSProperties["cpErrorMsg"] = "";
                        view.DataBind();
                        ASPxGridView1.StartEdit(view.FocusedRowIndex);
                    }


                }
            }
       }
 function onASPxGridView1ButtonClick(s, e) {
                switch (e.buttonID) {
                    case "EditButton":
                        e.processOnServer = true;
                       
                        break;
                    default: break;
                }
            }

function EndCallBack(s, e) {
        if (s.cpErrorMsg != "") {
            alert(s.cpErrorMsg);
        }
    }








https://docs.devexpress.com/AspNet/js-ASPxClientGridView.UpdateEdit
  function checkBrowser() {
          
            // Get the user-agent string
            let userAgentString = 
                navigator.userAgent;
          
            // Detect Chrome
            let chromeAgent = 
                userAgentString.indexOf("Chrome") > -1;
          
            // Detect Internet Explorer
            let IExplorerAgent = 
                userAgentString.indexOf("MSIE") > -1 || 
                userAgentString.indexOf("rv:") > -1;
          
            // Detect Firefox
            let firefoxAgent = 
                userAgentString.indexOf("Firefox") > -1;
          
            // Detect Safari
            let safariAgent = 
                userAgentString.indexOf("Safari") > -1;
                  
            // Discard Safari since it also matches Chrome
            if ((chromeAgent) && (safariAgent)) 
                safariAgent = false;
          
            // Detect Opera
            let operaAgent = 
                userAgentString.indexOf("OP") > -1;
                  
            // Discard Chrome since it also matches Opera     
            if ((chromeAgent) && (operaAgent)) 
                chromeAgent = false;
          
            document.querySelector(".output-safari").textContent
                        = safariAgent;
            document.querySelector(".output-chrome").textContent
                        = chromeAgent;
            document.querySelector(".output-ie").textContent
                        = IExplorerAgent;
            document.querySelector(".output-opera").textContent
                        = operaAgent;
            document.querySelector(".output-firefox").textContent
                        = firefoxAgent;
        }
(function() {
  function remove() { this.parentNode && this.parentNode.removeChild(this); }
  if (!Element.prototype.remove) Element.prototype.remove = remove;
  if (Text && !Text.prototype.remove) Text.prototype.remove = remove;
})();

if (!('remove' in Element.prototype)) {
  Element.prototype['remove'] = function () {
    if (this.parentNode) {
      this.parentNode.removeChild(this);
    }
  };
}
function ClosePopup() {  
    ASPxClientPopupControlInstance.Hide();  
}  
C#
protected void ..._Click(object sender, System.EventArgs e) {  
    ...  
    ClientScript.RegisterStartupScript(GetType(), "ANY_KEY", "window.parent.ClosePopup();", true);  
}  
<script type="text/javascript">  
    function OnCloseButtonClick(s, e) {  
        var parentWindow = window.parent;  
        parentWindow.popupWindow2.HideWindow(parentWindow.popupWindow2.GetWindow(0));  
    }  
</script> 

<input id="openBtn" type="button" value="Open popup" 
       onclick="myPopup.SetContentUrl('http://www.google.com');myPopup.Show();" />                

<dx:ASPxPopupControl runat="server" ClientInstanceName="myPopup" Modal="True" 
                     CloseAction="CloseButton" Width="500px" Height="400px"/>

<dx:ASPxPopupControl ID="popup" runat="server" ContentUrl="~/ContentPageWithTextBox.aspx"
        Top="100" ClientInstanceName="clientPopup" CloseAction="CloseButton">
        <ClientSideEvents Shown="OnShown" />
    </dx:ASPxPopupControl>
$.showModalDialog({
        url: url,
        dialogArguments: '課程資料查詢',
        height: 500,
        width: 900,
        scrollable: false,
        onClose: function()
        {
            var returnedValue = this.returnValue;
            $('#txt-cono').text(returnedValue.cono);
        }
    });
<%@ Page Language="C#" AutoEventWireup="True" CodeBehind="WebForm3.aspx.cs" Inherits="WebApplication2.WebForm3" %>

<%@ Register Assembly="DevExpress.Web.Bootstrap.v20.1, Version=20.1.7.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web.Bootstrap" TagPrefix="dx" %>

<%@ Register Assembly="DevExpress.Web.v20.1, Version=20.1.7.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web" TagPrefix="dx" %>
protected void Button1_Click(object sender, EventArgs e)
    {
        string sCode = "window.open('../Pages/Login.aspx', '_blank');";
        Page.ClientScript.RegisterStartupScript(this.GetType(), "CallAshx", sCode, true);   
    }
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="./css1/jquery-ui.css">
    <link rel="stylesheet" href="./css1/ui.jqgrid.css">
    <link rel="stylesheet" href="./css1/bootstrap.min.css">
    <link rel="stylesheet" href="./css1/bootstrap-datetimepicker.min.css">

    <script src="./js1/jquery-2.2.4.min.js"></script>
    <script src="./js1/jquery-ui.min.js"></script>
    <script src="./js1/jquery-migrate-1.2.1.js"></script>
    <script src="./js1/bootstrap.min.js"></script>
    <script src="./js1/moment.min.js"></script>
    <script src="./js1/bootstrap-datetimepicker.min.js"></script>
    <script src="./js1/jquery.jqGrid.src.js"></script>
    <title></title>
     <style type="text/css">
   .roundedBorders {  
    border-radius: 5px;  
    -moz-border-radius: 5px;  
    -khtml-border-radius: 5px;  
    -webkit-border-radius: 5px;  
    overflow: hidden !important;  
    overflow-x: hidden !important;  
    overflow-y: hidden !important;  
 </style>
     <script type="text/javascript">
         function ExportData() { CallbackPanel1.PerformCallback("ExportData"); }  
     </script>
</head>
<body>
    <form id="form1" runat="server" >
        <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
        <asp:HyperLink ID="HyperLink1" runat="server" NavigateUrl="https://localhost:44357/Handler1.ashx">Export to Excel</asp:HyperLink>
        <dx:ASPxGridViewExporter ID="ASPxGridViewExporter1" GridViewID="ASPxGridView1" runat="server"></dx:ASPxGridViewExporter>  

     <%--     <dx:ASPxButton ID="ASPxButton1" runat="server" Text="Reload Panel" AutoPostBack="False">
            <ClientSideEvents Click="function(s, e) {
	callbackPanel1.PerformCallback("export");
}" />
        </dx:ASPxButton>--%>
       <%--  <dx:ASPxCallbackPanel ID="ASPxCallbackPanel1" runat="server" ClientInstanceName="CallbackPanel1"
         Height="173px" oncallback="ASPxCallbackPanel1_Callback">
                <PanelCollection> 
                    <dx:PanelContent runat="server">  --%>
        <asp:UpdatePanel ID="UpdatePanel1" runat="server">
               <ContentTemplate>
        <div class="container-fluid form-group">
            <div class="panel panel-primary" id="accordion">
                <div class="panel-heading clearfix">
                    <h3 class="panel-title pull-left">
                        <span class="glyphicon glyphicon-edit"></span>
                        <span>填表人资料 Author Information</span>
                    </h3>
                    <h3 class="panel-title pull-right"> 
                       <a aria-controls="head1" aria-expanded="true" data-parent="#accordion" 
                           data-toggle="collapse" href="#head" role="button">
                           <span class="glyphicon glyphicon-collapse-down"></span> 
                       </a>
                    </h3>
                </div>
                <div id="head" class="panel-collapse collapse in">
                   <div class="panel-body">
                    <div class="row">
                        <div>
                             <dx:ASPxMenu ID="ASPxMenu1" runat="server"></dx:ASPxMenu>
                            <label class="form-inline">参加单位：<input type="text" class="form-control" /></label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <label>
                                单号<br />
                                From No</label>
                            <div class="form-group">
                                <input id="txtFromNo" type="text" class="form-control" data-msg="" readonly="readonly" style="text-align: right; width: 100%;">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4"> 
                            <div class="form-group form-inline">
                                <div style="display: flex; flex-direction: row; justify-content: flex-start; align-items: center">
                                    <label for="Student" style="text-align: left!important;margin-top:10px">Name:</label>
                                    <dx:ASPxRadioButtonList ID="ASPxRadioButtonList1" class="form-control" runat="server" TextAlign="Right" RepeatDirection="Horizontal" RepeatColumns="3"
                                        Style="width: 99%">
                                        <Items>
                                            <dx:ListEditItem Value="0" Selected="True" Text="Yes "></dx:ListEditItem>
                                            <dx:ListEditItem Value="1" Selected="false" Text="No "></dx:ListEditItem>
                                            <dx:ListEditItem Value="2" Selected="false" Text="N/A"></dx:ListEditItem>
                                        </Items>
                                        <Border BorderWidth="0" />
                                        <Border BorderStyle="None" />
                                        <BorderLeft BorderStyle="None" />
                                        <BorderTop BorderStyle="None" />
                                        <BorderRight BorderStyle="None" />
                                        <BorderBottom BorderStyle="None" />
                                    </dx:ASPxRadioButtonList>
                                </div>
                            </div>


                           <%-- <div class="form-group">
                                <label for="State" class="col-md-2 control-label">工号</label>
                                <div class="col-md-10">
                                    <dx:ASPxRadioButtonList ID="ASPxRadioButtonList1" class="form-control" runat="server" TextAlign="Right" RepeatDirection="Horizontal" RepeatColumns="3"
                                        Style="width: 99%">
                                        <Items>
                                            <dx:ListEditItem Value="0" Selected="True" Text="Yes "></dx:ListEditItem>
                                            <dx:ListEditItem Value="1" Selected="false" Text="No "></dx:ListEditItem>
                                            <dx:ListEditItem Value="2" Selected="false" Text="N/A"></dx:ListEditItem>
                                        </Items>
                                        <Border BorderWidth="0" />
                                        <Border BorderStyle="None" />
                                        <BorderLeft BorderStyle="None" />
                                        <BorderTop BorderStyle="None" />
                                        <BorderRight BorderStyle="None" />
                                        <BorderBottom BorderStyle="None" />
                                    </dx:ASPxRadioButtonList>
                                </div>

                                <div class="form-group">
                                    <label for="Name" class="col-md-4 control-label">Name</label>
                                    <div class="col-md-8">
                                        <input id="Name" type="text" class="form-control" />
                                    </div>
                                </div>

                            </div>--%>



                            <%--  <div class="form-group">
                                <label>工号</label>
                                <dx:ASPxRadioButtonList ID="rblBagJulianDate" runat="server" TextAlign="Right" RepeatDirection="Horizontal" RepeatColumns="3"
                                    Style="width: 99%">
                                    <Items>
                                        <dx:ListEditItem Value="0" Selected="True" Text="Yes "></dx:ListEditItem>
                                        <dx:ListEditItem Value="1" Selected="false" Text="No "></dx:ListEditItem>
                                        <dx:ListEditItem Value="2" Selected="false" Text="N/A"></dx:ListEditItem>
                                    </Items>
                                    <Border BorderWidth="0" />
                                    <Border BorderStyle="None" />
                                    <BorderLeft BorderStyle="None" />
                                    <BorderTop BorderStyle="None" />
                                    <BorderRight BorderStyle="None" />
                                    <BorderBottom BorderStyle="None" />
                                </dx:ASPxRadioButtonList>
                            </div>--%>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group form-inline">
                                <div style="display: flex; flex-direction: row; justify-content: flex-start; align-items: center">
                                    <label for="Student" style="text-align: left!important;">Name:</label>
                                    <input name="Student" id="Student" class="form-control" style="text-align: left; margin-left: 10px; width:100%"; />
                                </div>
                            </div>
                            <%--<div class="form-group form-inline">
                                <label for="exampleInputEmail1">Email</label>
                                <input type="text" class="form-control" id="firstname" placeholder="请输入名字" style="text-align: left;">
                            </div>--%>
                           <%-- <div class="form-group">
                                <label for="firstname" class="col-sm-2 control-label">名字</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="firstname" placeholder="请输入名字">
                                </div>
                            </div>--%>
                           <%-- <div class="form-group">
                                <label for="State" class="col-md-2">姓名</label>
                                <div class="col-md-10">
                                    <input id="txtCname" type="text" class="form-control" data-msg="" readonly="readonly" style="text-align: right; width: 100%;">
                                </div>
                            </div>--%>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="State" class="col-md-2 control-label">英文名</label>
                                <div class="col-md-10">
                                    <input id="txtEname" type="text" class="form-control" data-msg="" readonly="readonly" style="text-align: right; width: 100%;">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label>分机 EXT Number</label></span><br />
                            <div class="form-group">
                                <input id="txtExt" type="text" class="form-control" data-msg="" readonly="readonly" style="text-align: right; width: 100%;">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label>进出口类型 Type of Import/Export</label></span><br />
                            <div class="form-group">
                               
                                <dx:ASPxDropDownEdit ClientInstanceName="checkComboBox" ID="ASPxDropDownEdit1" Width="100%" runat="server" AnimationType="None" class="form-control" Height="34px" CssClass="roundedBorders" >
                                    <DropDownWindowStyle BackColor="#EDEDED" />
                                    <DropDownWindowTemplate>
                                     <%--     <div style="height: 300px; width: 270px; overflow: auto">--%>
                                        <dx:ASPxListBox Width="100%" ID="listBox" ClientInstanceName="checkListBox" SelectionMode="CheckColumn"
                                            runat="server" Height="300" EnableSelectAll="true">
                                            <FilteringSettings ShowSearchUI="true" />
                                            <Border BorderStyle="None" />
                                            <BorderBottom BorderStyle="Solid" BorderWidth="1px" BorderColor="#DCDCDC" />
                                            <Items>
                                                <dx:ListEditItem Text="Chrome" Value="0" Selected="true" />
                                                <dx:ListEditItem Text="Firefox" Value="1" />
                                                <dx:ListEditItem Text="IE" Value="2" />
                                                <dx:ListEditItem Text="Opera" Value="3" />
                                                <dx:ListEditItem Text="Safari" Value="4" Selected="true" />
                                            </Items>
                                         
                                        </dx:ASPxListBox>
                                        <table style="width: 100%">
                                            <tr>
                                                <td style="padding: 4px">
                                                    <dx:ASPxButton ID="ASPxButton1" AutoPostBack="false" runat="server"  OnClick="btnTest_Click" Text="Close" Style="float: right">

                                                    </dx:ASPxButton>
                                                    <%--  <dx:ASPxButton ID="ASPxButton2" AutoPostBack="false" runat="server"  OnClick="btnTest_Click" Text="Close" Style="float: right">
                                                         <ClientSideEvents Click="ExportData" />  
                                                              </dx:ASPxButton>   --%>
                                                             </td>
                                            </tr>
                                        </table>    
                                      <%--  </div>--%>
                                    </DropDownWindowTemplate>
                                 <DropDownWindowStyle BackColor=#EDEDED>
                               </DropDownWindowStyle>
                                </dx:ASPxDropDownEdit>
                          
                                      </div>
                        </div>
                        <div class="col-md-4">
                            <label>填写日期 Apply date</label><br />
                            <div class="form-group">
                                <dx:ASPxTextBox ID="ASPxTextBox1" runat="server" Width="170px"></dx:ASPxTextBox>
                                <asp:Button ID="Button1" runat="server" class="btn btn-primary" Text="Button" OnClick="Button1_Click" /> 
                                <dx:ASPxButton ID="ASPxButton3" AutoPostBack="false" runat="server" OnClick="btnTest1_Click" Text="Close" Style="float: right"><%-- OnClick="btnTest1_Click"--%> 
                                                      <%--   <ClientSideEvents Click="ExportData" />  --%>
                                                              </dx:ASPxButton>
                            </div>
                        </div>
                    </div>

                </div>
                </div> 
            </div>
             <div id="divTax2" class="panel panel-primary">

                    <div class="panel panel-primary">
                        <div class="panel-heading clearfix">
                            <h3 class="panel-title pull-left">
                                <span class="glyphicon glyphicon-edit"></span>
                                <span>關務第二次確認</span>
                            </h3>
                            <h3 class="panel-title pull-right"></h3>
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <dx:ASPxGridView ID="ASPxGridView1" runat="server"  OnPageIndexChanged="ASPxGridView1_PageIndexChanged" OnDataBinding="ASPxGridView1_DataBinding">
                                        <Columns>
                                            <dx:GridViewDataColumn Caption="LogID" FieldName="col1" />
                                            <dx:GridViewDataColumn Caption="發生時間" FieldName="col2" />
                                        </Columns>
                                        <SettingsPager PageSize="15" />
                                         <%--<Settings VerticalScrollBarMode="Auto" />--%>  
                                        <SettingsBehavior AllowSort="true" SortMode="Value"/>  
                                        <%--<Settings VerticalScrollBarMode="Auto" VerticalScrollBarStyle="Virtual" VerticalScrollableHeight ="300" />--%>
                                                                               
                                    </dx:ASPxGridView>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
                     </ContentTemplate>
                 <Triggers>
           <%--  <asp:AsyncPostBackTrigger ControlID="ASPxButton1" EventName="Click" />--%>
            <%-- <asp:AsyncPostBackTrigger ControlID="ASPxButton2" EventName="Click" />--%>
             <asp:AsyncPostBackTrigger ControlID="ASPxButton3" EventName="Click" />
         </Triggers>
</asp:UpdatePanel>
        <div id="default-popup-control-4" class="popup-target popup-target-sm"></div>
        <dx:BootstrapPopupControl runat="server"  ID="BootstrapPopupControl1" ShowOnPageLoad="false" PopupElementCssSelector="#default-popup-control-4"
            PopupHorizontalAlign="Center" PopupVerticalAlign="Middle" Width="500px" CloseAction="CloseButton"
            AllowResize="true" Modal="true">
            <ContentCollection>
                <dx:ContentControl> 
                </dx:ContentControl>
            </ContentCollection>
        </dx:BootstrapPopupControl>   
           <%--  </dx:PanelContent>
                       </PanelCollection>
      </dx:ASPxCallbackPanel>--%>
    </form>
</body>
</html>
 


 
 
using DevExpress.Web;
using DevExpress.Web.Export;
using DevExpress.XtraPrinting;
using DevExpress.XtraPrintingLinks;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication2
{
    public partial class WebForm3 : System.Web.UI.Page
    {
        // DataTable workTable = new DataTable();
        private DataTable workTable
        {
            get 
            {
                return (DataTable)ViewState["uid"];
            }
            set 
            {
                ViewState["uid"] = value; 

            } 
        }
        protected void Page_Load(object sender, EventArgs e)
        {
            //  ASPxDropDownEdit.AdjustDropDownWindow();
            if (!IsPostBack)
            {
                DataTable workTable1 = new DataTable();
                DataColumn dc = new DataColumn("col1", typeof(String));
                workTable1.Columns.Add(dc);

                dc = new DataColumn("col2", typeof(String));
                workTable1.Columns.Add(dc);
  
                DataRow workRow;

                for (int i = 0; i <= 19; i++)
                {
                    workRow = workTable1.NewRow();
                    workRow["col1"] = i;
                    workRow["col2"] = "CustName" + i.ToString();
                    workTable1.Rows.Add(workRow);
                }
                workTable1.AcceptChanges();
                workTable = workTable1;
            }

        }

        protected void btnTest1_Click(object sender, EventArgs e)
        {
            PrintingSystem ps = new PrintingSystem();

            PrintableComponentLink link1 = new PrintableComponentLink(ps);
            link1.Component = ASPxGridViewExporter1;
            CompositeLink compositeLink = new CompositeLink(ps);
            compositeLink.Links.AddRange(new object[] { link1 });

            compositeLink.CreateDocument();
            XlsExportOptions options = new XlsExportOptions();
            using (MemoryStream stream = new MemoryStream())
            {
                compositeLink.PrintingSystem.ExportToXls(stream);
                Session["hh"] = stream;
                // WriteToResponse("filename", true, "xls", stream);
            }
            ps.Dispose();
        }
            
        protected void btnTest_Click(object sender, EventArgs e)
        {
            string unitStr = string.Empty;
            foreach (ListEditItem item in ((ASPxListBox)ASPxDropDownEdit1.FindControl("listbox")).Items)
            {
                if (item.Selected)
                {
                    unitStr += item.Text + ",";
                }
            }
            unitStr = unitStr.TrimEnd(',');
            // ((ASPxDropDownEdit)ASPxDropDownEdit1.FindControl("ASPxDropDownEdit1")).Text = unitStr;

            ASPxDropDownEdit1.Text= unitStr; ;
        }

        protected void Button1_Click(object sender, EventArgs e)
        {
            //BootstrapPopupControl1.ShowCloseButton = true;
            //BootstrapPopupControl1.HeaderText = "test";
            //BootstrapPopupControl1.Text = "good";
            //BootstrapPopupControl1.ShowOnPageLoad =true;
            
            ASPxGridView1.DataSource = workTable;
            ASPxGridView1.DataBind();
        }

        protected void ASPxGridView1_PageIndexChanged(object sender, EventArgs e)
        {
            var view = sender as ASPxGridView;
            if (view == null) return; 
            ASPxGridView1.PageIndex = view.PageIndex;
            ASPxGridView1.DataSource = workTable;
          //  ASPxGridView1.Settings.VerticalScrollableHeight = 
            ASPxGridView1.DataBind();
        }

        protected void grid_CustomColumnSort (object sender, DevExpress.Web.CustomColumnSortEventArgs e)
        {
            //if (e.Column.FieldName == "Country")
            //{
                e.Handled = true;
                string s1 = e.Value1.ToString(), s2 = e.Value2.ToString();
                if (s1.Length > s2.Length)
                    e.Result = 1;
                else
                    if (s1.Length == s2.Length)
                    e.Result = Comparer.Default.Compare(s1, s2);
                else
                    e.Result = -1;
            //}
        }

        protected void ASPxGridView1_DataBinding(object sender, EventArgs e)
        {
            ASPxGridView1.DataSource = workTable;
        }
        protected void WriteToResponse(string fileName, bool saveAsFile, string fileFormat, MemoryStream stream)
        {
            byte[] mem = stream.GetBuffer();
            if (Page == null || Page.Response == null) return;
            string disposition = saveAsFile ? "attachment" : "inline";
            Page.Response.Clear();
            Page.Response.Buffer = false;
            Page.Response.AppendHeader("Content-Type", string.Format("application/{0}", fileFormat));
            Page.Response.AppendHeader("Content-Transfer-Encoding", "binary");
            Page.Response.AppendHeader("Content-Disposition", string.Format("{0}; filename={1}.{2}", disposition, HttpUtility.UrlEncode(fileName).Replace("+", "%20"), fileFormat));
            Page.Response.BinaryWrite(stream.ToArray());
            Page.Response.End();
        }
        protected void ASPxCallbackPanel1_Callback(object sender, DevExpress.Web.CallbackEventArgsBase e)
        {
            try
            {
                

                  
                
                //}
                //GridViewLink lnk = new GridViewLink(ASPxGridViewExporter1);
                //PrintingSystem ps = lnk.CreatePS();

                //MemoryStream stream = new MemoryStream();
                //string type = string.Empty;
                //ps.ExportToXls(stream);
                //type = "xls";
                //Session["ExportStreame"] = stream;
                //Session["type"] = type;
                //ASPxGridViewExporter1.WriteXlsxToResponse("Customer-" + DateTime.Now.ToString("MM-dd-yyyy"));
            }
            catch (Exception ex)
            { 
            
            }
            //ASPxCallbackPanel panel = (ASPxCallbackPanel)sender;
            //NoCommentsLabel.Visible = false;
            //Thread.Sleep(3000);

            //ASPxLabel comment = new ASPxLabel()
            //{
            //    Text = string.Format("[{0}]\n{1}\n\n",
            //        DateTime.Now.ToLocalTime(),
            //        !string.IsNullOrEmpty(TextBox.Text) ? TextBox.Text : "Empty comment"
            //    ),
            //    CssClass = "comment"
            //};

            //List<ASPxLabel> comments = (List<ASPxLabel>)Session["comments"] ?? new List<ASPxLabel>();

            //comments.Add(comment);
            //panel.Controls.Add(comment);
            //Session["comments"] = comments;

            //CountLabel.Text = "Comments Count : " + comments.Count;
        }
    }
}

using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.SessionState;

namespace WebApplication2
{
    /// <summary>
    /// Handler1 的摘要描述
    /// </summary>
    public class Handler1 : IHttpHandler, IRequiresSessionState
    {

        public void ProcessRequest(HttpContext context)
        {
            context.Response.AddHeader("content-disposition", "attachment; filename=FileName.xls");
            context.Response.ContentType = "application/ms-excel";
            HttpRequest request = context.Request;
            HttpResponse response = context.Response;
            MemoryStream ms = (MemoryStream)context.Session["hh"];
            byte[] imageBytes = ms.ToArray();
            context.Response.OutputStream.Write(imageBytes, 0, imageBytes.Length);
            context.Response.Flush();
            System.Web.HttpContext.Current.ApplicationInstance.CompleteRequest();
        }

        public bool IsReusable
        {
            get
            {
                return false;
            }
        }
    }
}
